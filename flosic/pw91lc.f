C UTEP Electronic Structure Lab (2019)
C
C
C
      SUBROUTINE PW91LC(RS,ZET,EC,VCUP,VCDN,ECRS,ECZET,ALFC)
C
C  UNIFORM-GAS CORRELATION OF PERDEW AND WANG 1991
C  INPUT: SEITZ RADIUS (RS), RELATIVE SPIN POLARIZATION (ZET)
C  OUTPUT: CORRELATION ENERGY PER ELECTRON (EC), 
C          UP- AND DOWN-SPIN POTENTIALS (VCUP,VCDN), 
C          DERIVATIVES OF EC VERSUS RS (ECRS) & ZET (ECZET),
C          CORRELATION CONTRIBUTION (ALFC) TO THE SPIN STIFFNESS 
C
      IMPLICIT REAL*8 (A-H,O-Z)
      DATA GAMR,FZZR/1.92366105D0,0.58482234D0/
      DATA THRD,THRD4/0.333333333333D0,1.333333333333D0/
      ZETPR = (1.0D0+ZET)**THRD
      ZETMR = (1.0D0-ZET)**THRD
      F = (ZETPR**4+ZETMR**4-2.0D0)*GAMR
      CALL GCOR(0.0310907D0,0.21370D0,7.5957D0,3.5876D0,1.6382D0,
     &          0.49294D0,RS,EU,EURS)
      CALL GCOR(0.01554535D0,0.20548D0,14.1189D0,6.1977D0,3.3662D0,
     &          0.62517D0,RS,EP,EPRS)
      CALL GCOR(0.0168869D0,0.11125D0,10.357D0,3.6231D0,0.88026D0,
     &          0.49671D0,RS,ALFM,ALFRSM)
C
C  ALFM IS MINUS THE SPIN STIFFNESS ALFC
C
      ALFC = -ALFM
      Z3 = ZET**3
      Z4 = Z3*ZET
      EC = EU*(1.0D0-F*Z4)+EP*F*Z4-ALFM*F*(1.0D0-Z4)*FZZR
C
C  ENERGY DONE. NOW THE POTENTIAL:
C
      ECRS = EURS*(1.0D0-F*Z4)+EPRS*F*Z4-ALFRSM*F*(1.0D0-Z4)*FZZR
      FZ = THRD4*(ZETPR-ZETMR)*GAMR
      ECZET = 4.0D0*Z3*F*(EP-EU+ALFM*FZZR)
     &      +FZ*(Z4*EP-Z4*EU-(1.0D0-Z4)*ALFM*FZZR)
      COMM = EC-RS*ECRS*THRD-ZET*ECZET
      VCUP = COMM + ECZET
      VCDN = COMM - ECZET
      RETURN
      END
